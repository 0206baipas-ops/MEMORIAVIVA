import{_ as N}from"./ABOUT-yPVQ1ME-.js";import{_ as U,r as p,i as I,w as z,o as F,c,j as k,a as t,b as f,d as y,n as _,e as L,F as C,g as M,k as j,h as m,t as q}from"./index-C06M_G74.js";const x={class:"titles"},D={class:"parades-bar"},T={class:"parades-scroll"},G=["onClick"],H=["src","alt"],J={class:"thumbnail-label"},K={class:"memoria"},O={class:"content-wrapper"},P={class:"central-media"},Q=["src"],W=["src"],X={key:0,class:"side-images"},Y={class:"side-scroll"},Z=["src","onClick"],ee={__name:"Memoria",setup(ae){const n=p([]),a=p(0),o=p(0),g=p(null),h=p(!0);async function V(){try{const e=await fetch("/memoriaviva/Llistamemoria.json");if(!e.ok)throw new Error("No s’ha pogut carregar Llistamemoria.json");const l=await e.json();n.value=l.map(i=>{const s={...i},u=s.media.findIndex(d=>d.type==="video");if(u!==-1){const d=s.media.splice(u,1)[0];s.media.unshift(d)}const r=s.media.find(d=>d.type==="image")||s.media[0];return r&&(s.image=`/somni/${encodeURIComponent(s.carpeta)}/${r.name}`),s})}catch(e){console.error("Error carregant Llistamemoria.json:",e)}}function A(){h.value=!1,localStorage.setItem("memoriaIntroSeen","true")}const v=I(()=>n.value[a.value]?.media?.[o.value]||null),b=I(()=>{const e=v.value;return e?`/somni/${encodeURIComponent(n.value[a.value].carpeta)}/${e.name}`:""}),$=I(()=>{const e=n.value[a.value];return e?.media?e.media.some(i=>i.type==="video")?e.media.filter(i=>i.type==="image"):e.media.filter((i,s)=>s!==o.value):[]});function B(){return n.value[a.value]?.color||"#ece1c4"}function E(e){a.value=e,o.value=0,w()}function R(){const e=n.value[a.value];o.value+1<e.media.length?o.value++:a.value<n.value.length-1?(a.value++,o.value=0):(a.value=0,o.value=0)}function w(){S(),v.value?.type!=="video"&&(g.value=setInterval(()=>{const e=n.value[a.value];o.value<e.media.length-1?o.value++:a.value<n.value.length-1?(a.value++,o.value=0):(a.value=0,o.value=0)},4e3))}function S(){g.value&&(clearInterval(g.value),g.value=null)}return z(v,e=>{e?.type==="video"?S():w()},{immediate:!0}),F(async()=>{await V(),localStorage.getItem("memoriaIntroSeen")==="true"?h.value=!1:setTimeout(()=>{h.value=!1,localStorage.setItem("memoriaIntroSeen","true")},4e3)}),(e,l)=>{const i=L("router-link"),s=L("AboutButton");return m(),c(C,null,[h.value?(m(),c("div",{key:0,class:"intro-fullscreen",onClick:A},[...l[0]||(l[0]=[t("p",{class:"intro-text"}," Una passejada visual per la memòria de Reus: imatges i vídeos que parlen del passat. ",-1)])])):k("",!0),t("div",x,[f(i,{to:"/somni",class:_(["title-left",{actiu:e.$route.path==="/somni"}])},{default:y(()=>[...l[1]||(l[1]=[t("h1",null,"Somni",-1)])]),_:1},8,["class"]),f(i,{to:"/memoria",class:_(["title-center",{actiu:e.$route.path==="/memoria"}])},{default:y(()=>[...l[2]||(l[2]=[t("h1",null,"Memòria",-1)])]),_:1},8,["class"]),f(i,{to:"/ruta",class:_(["title-right",{actiu:e.$route.path==="/ruta"}])},{default:y(()=>[...l[3]||(l[3]=[t("h1",null,"Ruta",-1)])]),_:1},8,["class"])]),t("div",D,[t("div",T,[(m(!0),c(C,null,M(n.value,(u,r)=>(m(),c("div",{key:r,class:_(["parade-thumbnail",{active:r===a.value}]),style:j({backgroundColor:r===a.value?u.color:"transparent"}),onClick:d=>E(r)},[t("img",{src:u.image,alt:u.nom,class:"thumbnail-image"},null,8,H),t("div",J,q(u.nom),1)],14,G))),128))])]),t("div",K,[t("div",{class:"main-container",style:j({backgroundColor:B()})},[t("div",O,[t("div",P,[v.value&&v.value.type==="video"?(m(),c("video",{key:0,src:b.value,class:"central-video",autoplay:"",muted:"",playsinline:"",controls:"",onEnded:R},null,40,Q)):v.value?(m(),c("img",{key:1,src:b.value,class:"central-image",alt:""},null,8,W)):k("",!0)]),$.value.length>0?(m(),c("div",X,[t("div",Y,[(m(!0),c(C,null,M($.value,(u,r)=>(m(),c("img",{key:r,src:`/somni/${encodeURIComponent(n.value[a.value].carpeta)}/${u.name}`,class:_(["side-image",{active:o.value===r}]),alt:"",onClick:d=>o.value=r},null,10,Z))),128))])])):k("",!0)])],4)]),f(s),f(i,{to:"/about",class:"about-btn"},{default:y(()=>[...l[4]||(l[4]=[t("img",{src:N,alt:"About"},null,-1)])]),_:1})],64)}}},le=U(ee,[["__scopeId","data-v-8cdfd324"]]);export{le as default};
